import{c as B,ak as N,al as v,am as z,j as e,F as p,an as y,ao as c,ap as o,aq as m,ar as x,a9 as h,as as u,H as P,Q as V,at as C,au as j,r as A,ad as H,av as O,aw as T,x as _,K as L}from"./index-B0lCFcsv.js";import{D as k,a as E,b as I,c as M,d as R,e as D,f as S}from"./dialog-Bi4V3Jxl.js";import{u as F}from"./hooks-B87JGVFV.js";import{C as $}from"./car-Cb7h5jJd.js";import{B as Q}from"./badge-BPiHxISA.js";import"./index-BKouJd5v.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],K=B("pencil",q),G=C({name:j().min(3,"Name must be at least 3 characters")}),J=C({oldPassword:j().min(5,"Enter current password"),newPassword:j().min(5,"New password must be at least 5 chars"),confirmPassword:j().min(5,"Confirm your new password")}).refine(a=>a.newPassword===a.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});function W({user:a}){const{showToast:s}=V(),i=N({resolver:v(G),defaultValues:{name:a.name||""}}),t=N({resolver:v(J),defaultValues:{oldPassword:"",newPassword:"",confirmPassword:""}}),[g]=z(),f=F(),n=async l=>{try{console.log("Update name:",l,a),await g({id:a?._id,payload:l}).unwrap(),f(P.util.resetApiState()),s({message:`Name updated to "${l.name}"`,type:"success"})}catch(r){s({message:r?.message||r?.data?.message,type:"error"})}},w=async l=>{try{console.log("Update :",l,a);const r={newPassword:l.newPassword,oldPassword:l.oldPassword};await g({id:a?._id,payload:r}).unwrap(),f(P.util.resetApiState()),s({message:"Password updated",type:"success"})}catch(r){s({message:r?.message||r?.data?.message,type:"error"})}};return e.jsxs(k,{children:[e.jsx(E,{asChild:!0,children:e.jsx(p,{className:"bg-yellow-600 hover:bg-orange-700 text-white",children:"Edit Profile"})}),e.jsxs(I,{className:"sm:max-w-lg",children:[e.jsxs(M,{children:[e.jsx(R,{children:"Update Profile"}),e.jsx(D,{children:"Update your name or password securely."})]}),e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsx(y,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(n),className:"space-y-4",children:[e.jsx(c,{control:i.control,name:"name",render:({field:l})=>e.jsxs(o,{children:[e.jsx(m,{children:"Full Name"}),e.jsx(x,{children:e.jsx(h,{placeholder:"Enter your name",...l})}),e.jsx(u,{})]})}),e.jsx(S,{children:e.jsx(p,{type:"submit",className:"bg-cyan-600 hover:bg-cyan-700",children:"Save Name"})})]})}),e.jsx(y,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(w),className:"space-y-4",children:[e.jsx(c,{control:t.control,name:"oldPassword",render:({field:l})=>e.jsxs(o,{children:[e.jsx(m,{children:"Current Password"}),e.jsx(x,{children:e.jsx(h,{type:"password",placeholder:"Current password",...l})}),e.jsx(u,{})]})}),e.jsx(c,{control:t.control,name:"newPassword",render:({field:l})=>e.jsxs(o,{children:[e.jsx(m,{children:"New Password"}),e.jsx(x,{children:e.jsx(h,{type:"password",placeholder:"New password",...l})}),e.jsx(u,{})]})}),e.jsx(c,{control:t.control,name:"confirmPassword",render:({field:l})=>e.jsxs(o,{children:[e.jsx(m,{children:"Confirm New Password"}),e.jsx(x,{children:e.jsx(h,{type:"password",placeholder:"Confirm new password",...l})}),e.jsx(u,{})]})}),e.jsx(S,{children:e.jsx(p,{type:"submit",className:"bg-emerald-600 hover:bg-emerald-700",children:"Update Password"})})]})})]})]})]})}const X=C({license:j().min(2,{message:"License must be at least 2 characters."}),model:j().min(2,{message:"Model must be at least 2 characters."}),plateNumber:j().min(2,{message:"Plate number must be at least 2 characters."})}),Y={license:"",model:"",plateNumber:""};function Z({vehicleData:a=Y,userId:s}){const[i,t]=A.useState(!1),[g,f]=A.useState(!1),n=N({resolver:v(X),defaultValues:a});H.useEffect(()=>{i&&n.reset(a)},[i,a,n]);const[w]=O(),l=F(),{showToast:r}=V();async function U(d){f(!0);try{console.log(d,s),await w({id:s,payload:d}).unwrap(),r({message:"Vehicle  updated successfully!",type:"success"}),t(!1)}catch(b){r({message:b?.message||b?.data?.message,type:"error"}),console.error(b)}finally{f(!1),l(P.util.resetApiState())}}return e.jsxs(k,{open:i,onOpenChange:t,children:[e.jsx(E,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"w-[200px]",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),a?.license?"Edit Vehicle":"Add Vehicle"]})}),e.jsxs(I,{className:"sm:max-w-[500px]",children:[e.jsxs(M,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),a?.license?"Edit Vehicle":"Add New Vehicle"]}),e.jsx(D,{children:"Update your vehicle information and save changes."})]}),e.jsx(y,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(U),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(c,{control:n.control,name:"license",render:({field:d})=>e.jsxs(o,{children:[e.jsx(m,{children:"License"}),e.jsx(x,{children:e.jsx(h,{placeholder:"Enter license",...d})}),e.jsx(u,{})]})}),e.jsx(c,{control:n.control,name:"plateNumber",render:({field:d})=>e.jsxs(o,{children:[e.jsx(m,{children:"Plate Number"}),e.jsx(x,{children:e.jsx(h,{placeholder:"Enter plate number",...d})}),e.jsx(u,{})]})})]}),e.jsx(c,{control:n.control,name:"model",render:({field:d})=>e.jsxs(o,{children:[e.jsx(m,{children:"Model"}),e.jsx(x,{children:e.jsx(h,{placeholder:"Enter model",...d})}),e.jsx(u,{})]})}),e.jsxs(S,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsxs(p,{type:"submit",disabled:g,children:[g&&e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})})]})]})}function ne(){const{data:a}=_();if(!a||!a.data)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-30",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading user data..."})]})});const s=a.data;return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8 py-30",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-2xl overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"User Profile"}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Manage your account information"})]}),e.jsx("div",{children:e.jsx(W,{user:s})})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-5 rounded-xl",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Basic Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Full Name"}),e.jsx("p",{className:"text-gray-800",children:s.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Email Address"}),e.jsx("p",{className:"text-gray-800",children:s.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Username"}),e.jsx("p",{className:"text-gray-800",children:s.username})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Role"}),e.jsx(Q,{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:s.role}),s?.role===L.DRIVER&&e.jsxs("div",{className:"p-4 border rounded-lg shadow-sm bg-white space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-rose-500",children:"Vehicle Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium ",children:"License:"})," ",s?.driver?.vehicleInfo?.license||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Model:"})," ",s?.driver?.vehicleInfo?.model||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Plate Number:"})," ",s?.driver?.vehicleInfo?.plateNumber||"N/A"]})]})]}),s?.role===L.DRIVER&&e.jsx(Z,{userId:s?.driver?._id,vehicleData:s?.driver?.vehicleInfo})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-5 rounded-xl",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732l-3.354 1.935-1.18 4.455a1 1 0 01-1.933 0L9.854 12.2 6.5 10.266a1 1 0 010-1.732l3.354-1.935 1.18-4.455A1 1 0 0112 2z",clipRule:"evenodd"})}),"Status Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Account Status"}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${s.isBlocked?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.isBlocked?"Blocked":"Active"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Online Status"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-3 w-3 rounded-full mr-2 ${s.isOnline?"bg-green-500":"bg-gray-400"}`}),e.jsx("span",{className:s.isOnline?"text-green-600 font-medium":"text-gray-600",children:s.isOnline?"Online":"Offline"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Last Online"}),e.jsx("p",{className:"text-gray-800",children:new Date(s.lastOnlineAt).toLocaleString()})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-5 rounded-xl md:col-span-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),"Current Location"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Address"}),e.jsx("p",{className:"text-gray-800",children:s.location?.address||"No address provided"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-5 rounded-xl md:col-span-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),"Account Dates"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Created At"}),e.jsx("p",{className:"text-gray-800",children:new Date(s.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Last Updated"}),e.jsx("p",{className:"text-gray-800",children:new Date(s.updatedAt).toLocaleString()})]})]})]})]})})]})})})}export{ne as default};
